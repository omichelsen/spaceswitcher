(function(e,t,n){"use strict";function s(t,n){this.element=t;this.options=e.extend({},i,n);this._defaults=i;this._name=r;this.init()}var r="spaceswitcher",i={data:[]};s.prototype.init=function(){var n=this;n.$widget=e(n.element).append(n.template(n.options.data)).find("."+n._name);e(n.element).on("mouseenter."+n._name,function(){n.$widget.show().find("input").focus();n.resize()}).on("mouseleave."+n._name,function(){n.$widget.hide().find("input").blur()});n.setSelected(n.$widget.find(".header:first"));n.$widget.find(".search-input").keyup(function(r){var i=n.unquote(e(this).val());e(".group",n.$widget).children().removeSearch().show().search(i).end().removeHighlight().highlight(i).filter(".item").not(".match").hide().end().end().end().show().not(function(){return e(this).children().hasClass("match")}).hide();switch(r.which){case 13:t.location=n.getSelected().attr("href");r.preventDefault();break;case 38:n.selectPrev();r.preventDefault();break;case 40:n.selectNext();r.preventDefault();break;default:n.setSelected(e(".header:first",n.$widget));n.setSelected(e(".match:first",n.$widget))}});e(t).on("resize."+n._name,function(){n.resize()})};s.prototype.destroy=function(){e(this.element).off("."+this._name).remove("."+this._name);e(t).off("."+this._name);e.removeData(this.element,"plugin_"+this._name)};s.prototype.scrollTo=function(e){var t=this.$widget.find(".results"),n=t.height(),r=e.position().top;(r<0||r+e.height()>n)&&t.scrollTop(r)};s.prototype.getSelected=function(){return this.$widget.find(".selected")};s.prototype.setSelected=function(e){if(!e.length)return;this.getSelected().removeClass("selected");this.scrollTo(e);return e.addClass("selected")};s.prototype.selectNext=function(){var e=this.getSelected(),t=e.nextAll(":visible:first");t.length||(t=e.parent().nextAll(":visible:first").children(":visible:first"));t.length&&this.setSelected(t)};s.prototype.selectPrev=function(){var e=this.getSelected(),t=e.prevAll(":visible:first");t.length||(t=e.parent().prevAll(":visible:first").children(":visible:last"));t.length&&this.setSelected(t)};s.prototype.resize=function(){var e=this.$widget.height(),t=this.$widget.find(".search").height(),n=this.$widget.find(".results");n.height("auto");e-t<n.height()&&n.height(e-t)};s.prototype.template=function(e){var t='<div class="'+this._name+'">'+'<div class="search"><div class="inner"><input type="search" class="search-input" /></div></div>'+'<div class="results">'+this.templateResults(e)+"</div>"+"</div>";return t};s.prototype.templateResults=function(t){var n="";e.each(t,function(){n+='<div class="group"><a class="header" href="https://podio.com">'+this.name+"</a>";e.each(this.spaces,function(){n+='<a class="item" href="'+this.url+'">'+this.name+"</a>"});n+="</div>"});return n};s.prototype.unquote=function(e){return e.replace(/['"]/g,"")};e.fn[r]=function(t){return this.each(function(){e.data(this,"plugin_"+r)||e.data(this,"plugin_"+r,new s(this,t))})}})(jQuery,window);