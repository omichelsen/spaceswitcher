(function(e,t,n){"use strict";function s(t,n){this.element=t;this.options=e.extend({},i,n);this._defaults=i;this._name=r;this.init()}var r="spaceswitcher",i={data:[]};s.prototype.init=function(){var n=this;n.$widget=e(n.element).append(n.template(n.options.data)).find(".spaceswitcher");e(n.element).hover(function(){n.$widget.show().find("input").focus()},function(){n.$widget.hide().find("input").blur()});n.setSelected(n.$widget.find(".header:first"));n.$widget.find(".search-input").keyup(function(t){var r=n.unquote(e(this).val());e(".group",n.$widget).children().show().removeSearch().search(r).end().filter(".item").not(".match").hide().end().removeHighlight().highlight(r).end().end().show().not(function(){return e(this).children().hasClass("match")}).hide();if([38,40].indexOf(t.which)<0){n.setSelected(e(".match, .header",n.$widget).first());t.preventDefault()}});e("body").keydown(function(e){switch(e.which){case 13:t.location=n.getSelected().attr("href");e.preventDefault();break;case 38:n.navigate("↑");e.preventDefault();break;case 40:n.navigate("↓");e.preventDefault()}})};s.prototype.destroy=function(){e(this.element).off("."+this._name).remove(".spaceswitcher");e.removeData(this.element,"plugin_"+this._name)};s.prototype.getSelected=function(){return e(".spaceswitcher .selected")};s.prototype.setSelected=function(t){e(".spaceswitcher .selected",this.element).removeClass("selected");t.addClass("selected")};s.prototype.navigate=function(e){var t=e==="↓"?0:-1,n=this.getSelected(),r=n.index()+t,i=n.siblings(":visible").eq(r);if(r>=0&&i.length)this.setSelected(i);else{i=n.parent().siblings(":visible").eq(n.parent().index()+t).children(":visible").eq(t);i.length&&this.setSelected(i)}};s.prototype.template=function(e){var t='<div class="spaceswitcher"><div class="search"><input type="search" class="search-input" /></div><div class="results">'+this.templateResults(e)+"</div>"+"</div>";return t};s.prototype.templateResults=function(t){var n="";e.each(t,function(){n+='<div class="group"><a class="header" href="https://podio.com">'+this.name+"</a>";e.each(this.spaces,function(){n+='<a class="item" href="'+this.url+'">'+this.name+"</a>"});n+="</div>"});return n};s.prototype.unquote=function(e){return e.replace(/['"]/g,"")};e.fn[r]=function(t){return this.each(function(){e.data(this,"plugin_"+r)||e.data(this,"plugin_"+r,new s(this,t))})}})(jQuery,window);