(function(e,t,n){"use strict";function s(t,n){this.element=t;this.options=e.extend({},i,n);this._defaults=i;this._name=r;this.init()}var r="spaceswitcher",i={data:[]};s.prototype.init=function(){var n=this;n.$widget=e(n.element).append(n.template(n.options.data)).find(".spaceswitcher");e(n.element).hover(function(){n.$widget.show().find("input").focus()},function(){n.$widget.hide().find("input").blur()});n.setSelected(n.$widget.find(".header:first"));n.$widget.find(".search-input").keyup(function(r){var i=n.unquote(e(this).val());e(".group",n.$widget).children().show().removeSearch().search(i).end().filter(".item").not(".match").hide().end().removeHighlight().highlight(i).end().end().show().not(function(){return e(this).children().hasClass("match")}).hide();switch(r.which){case 13:t.location=n.getSelected().attr("href");r.preventDefault();break;case 38:n.selectPrev("↑");r.preventDefault();break;case 40:n.selectNext("↓");r.preventDefault();break;default:n.setSelected(e(".header:first",n.$widget));n.setSelected(e(".match:first",n.$widget))}})};s.prototype.destroy=function(){e(this.element).off("."+this._name).remove(".spaceswitcher");e.removeData(this.element,"plugin_"+this._name)};s.prototype.getSelected=function(){return e(".selected",this.$widget)};s.prototype.setSelected=function(e){if(!e.length)return;this.getSelected().removeClass("selected");e.addClass("selected")};s.prototype.selectNext=function(){var e=this.getSelected(),t=e.nextAll(":visible:first");t.length||(t=e.parent().nextAll(":visible:first").children(":visible:first"));t.length&&this.setSelected(t)};s.prototype.selectPrev=function(){var e=this.getSelected(),t=e.prevAll(":visible:first");t.length||(t=e.parent().prevAll(":visible:first").children(":visible:last"));t.length&&this.setSelected(t)};s.prototype.template=function(e){var t='<div class="spaceswitcher"><div class="search"><input type="search" class="search-input" /></div><div class="results">'+this.templateResults(e)+"</div>"+"</div>";return t};s.prototype.templateResults=function(t){var n="";e.each(t,function(){n+='<div class="group"><a class="header" href="https://podio.com">'+this.name+"</a>";e.each(this.spaces,function(){n+='<a class="item" href="'+this.url+'">'+this.name+"</a>"});n+="</div>"});return n};s.prototype.unquote=function(e){return e.replace(/['"]/g,"")};e.fn[r]=function(t){return this.each(function(){e.data(this,"plugin_"+r)||e.data(this,"plugin_"+r,new s(this,t))})}})(jQuery,window);